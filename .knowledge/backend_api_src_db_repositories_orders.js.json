{"is_source_file": true, "format": "JavaScript", "description": "This file defines a repository module for managing orders in a bookstore application. It includes functions for creating orders with transaction handling, fetching order details by ID with items and book info, and listing user orders. It interacts with a database through Knex.js, performing CRUD operations on 'orders', 'order_items', and 'books' tables.", "external_files": ["../connection"], "external_methods": ["getDb()"], "published": ["createOrder", "getOrderById", "listOrdersByUser"], "classes": [], "methods": [{"name": "createOrder({ userId, items })", "description": "Creates a new order with associated order items within a database transaction, validating stock, calculating totals, and updating stock levels.", "scope": "", "scopeKind": ""}, {"name": "getOrderById(id, dbOverride)", "description": "Retrieves an order and its associated items, including book details, by order ID.", "scope": "", "scopeKind": ""}, {"name": "listOrdersByUser(userId)", "description": "Lists all orders for a specific user, returning a summary without order items.", "scope": "", "scopeKind": ""}], "calls": ["getDb", "db.transaction", "trx('books').whereIn", "trx('orders').insert", "trx('order_items').insert", "trx('books').where().update", "trx('orders').where().update", "getOrderById"], "search-terms": ["OrdersRepository", "createOrder", "getOrderById", "listOrdersByUser", "transaction", "order_items", "book_id", "stock validation", "Knex", "SQL data access"], "state": 2, "file_id": 29, "knowledge_revision": 69, "git_revision": "", "ctags": [{"_type": "tag", "name": "createOrder", "path": "/home/kavia/workspace/code-generation/bookstore-browse-and-purchase-27252-27277/backend_api/src/db/repositories/orders.js", "pattern": "/^  createOrder,$/", "language": "JavaScript", "kind": "field", "scope": "module.exports", "scopeKind": "class"}, {"_type": "tag", "name": "createOrder", "path": "/home/kavia/workspace/code-generation/bookstore-browse-and-purchase-27252-27277/backend_api/src/db/repositories/orders.js", "pattern": "/^async function createOrder({ userId, items }) {$/", "language": "JavaScript", "kind": "function", "signature": "({ userId, items })"}, {"_type": "tag", "name": "getOrderById", "path": "/home/kavia/workspace/code-generation/bookstore-browse-and-purchase-27252-27277/backend_api/src/db/repositories/orders.js", "pattern": "/^async function getOrderById(id, dbOverride) {$/", "language": "JavaScript", "kind": "function", "signature": "(id, dbOverride)"}, {"_type": "tag", "name": "listOrdersByUser", "path": "/home/kavia/workspace/code-generation/bookstore-browse-and-purchase-27252-27277/backend_api/src/db/repositories/orders.js", "pattern": "/^async function listOrdersByUser(userId) {$/", "language": "JavaScript", "kind": "function", "signature": "(userId)"}], "hash": "a0665866c0d9d05234b2d19eb9f3a458", "format-version": 4, "code-base-name": "backend_api", "filename": "backend_api/src/db/repositories/orders.js", "fields": [{"name": "createOrder,", "scope": "module.exports", "scopeKind": "class", "description": "unavailable"}], "revision_history": [{"69": ""}]}