{"is_source_file": true, "format": "JavaScript", "description": "This file implements authentication services including user registration, login, JWT issuance, and verification for a web application. It interacts with user data stored in a database via imported repository functions and utilizes bcrypt for password hashing and jsonwebtoken for token management.", "external_files": ["../db/repositories/users"], "external_methods": ["findUserByEmail", "createUser", "getUserById"], "published": ["registerUser", "loginUser", "issueJwt", "verifyJwt"], "classes": [], "methods": [{"name": "registerUser(email, password, name)", "description": "Registers a new user with hashed password, throws an error if email already exists, and returns the user object and JWT token.", "scope": "", "scopeKind": ""}, {"name": "loginUser(email, password)", "description": "Authenticates a user with email and password, throws errors on invalid credentials, returns user data without password and a JWT token.", "scope": "", "scopeKind": ""}, {"name": "issueJwt(user)", "description": "Creates and signs a JWT token for the user using environment secrets and expiry settings.", "scope": "", "scopeKind": ""}, {"name": "verifyJwt(token)", "description": "Verifies a JWT token and returns the decoded payload if valid.", "scope": "", "scopeKind": ""}], "calls": ["findUserByEmail", "createUser", "getUserById", "bcrypt.hash", "bcrypt.compare", "jwt.sign", "jwt.verify"], "search-terms": ["auth.js", "JWT_SECRET", "registerUser", "loginUser", "issueJwt", "verifyJwt", "bcrypt", "jsonwebtoken"], "state": 2, "file_id": 25, "knowledge_revision": 56, "git_revision": "", "ctags": [{"_type": "tag", "name": "DEFAULT_BCRYPT_ROUNDS", "path": "/home/kavia/workspace/code-generation/bookstore-browse-and-purchase-27252-27277/backend_api/src/services/auth.js", "pattern": "/^const DEFAULT_BCRYPT_ROUNDS = 10;$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "DEFAULT_JWT_EXPIRES_IN", "path": "/home/kavia/workspace/code-generation/bookstore-browse-and-purchase-27252-27277/backend_api/src/services/auth.js", "pattern": "/^const DEFAULT_JWT_EXPIRES_IN = '7d';$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "bcrypt", "path": "/home/kavia/workspace/code-generation/bookstore-browse-and-purchase-27252-27277/backend_api/src/services/auth.js", "pattern": "/^const bcrypt = require('bcrypt');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "email", "path": "/home/kavia/workspace/code-generation/bookstore-browse-and-purchase-27252-27277/backend_api/src/services/auth.js", "pattern": "/^  const payload = { sub: String(user.id), email: user.email, name: user.name };$/", "language": "JavaScript", "kind": "property", "scope": "issueJwt.payload", "scopeKind": "class"}, {"_type": "tag", "name": "issueJwt", "path": "/home/kavia/workspace/code-generation/bookstore-browse-and-purchase-27252-27277/backend_api/src/services/auth.js", "pattern": "/^function issueJwt(user) {$/", "language": "JavaScript", "kind": "function", "signature": "(user)"}, {"_type": "tag", "name": "jwt", "path": "/home/kavia/workspace/code-generation/bookstore-browse-and-purchase-27252-27277/backend_api/src/services/auth.js", "pattern": "/^const jwt = require('jsonwebtoken');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "loginUser", "path": "/home/kavia/workspace/code-generation/bookstore-browse-and-purchase-27252-27277/backend_api/src/services/auth.js", "pattern": "/^async function loginUser(email, password) {$/", "language": "JavaScript", "kind": "function", "signature": "(email, password)"}, {"_type": "tag", "name": "name", "path": "/home/kavia/workspace/code-generation/bookstore-browse-and-purchase-27252-27277/backend_api/src/services/auth.js", "pattern": "/^  const payload = { sub: String(user.id), email: user.email, name: user.name };$/", "language": "JavaScript", "kind": "property", "scope": "issueJwt.payload", "scopeKind": "class"}, {"_type": "tag", "name": "payload", "path": "/home/kavia/workspace/code-generation/bookstore-browse-and-purchase-27252-27277/backend_api/src/services/auth.js", "pattern": "/^  const payload = { sub: String(user.id), email: user.email, name: user.name };$/", "language": "JavaScript", "kind": "class", "scope": "issueJwt", "scopeKind": "class"}, {"_type": "tag", "name": "registerUser", "path": "/home/kavia/workspace/code-generation/bookstore-browse-and-purchase-27252-27277/backend_api/src/services/auth.js", "pattern": "/^  registerUser,$/", "language": "JavaScript", "kind": "field", "scope": "module.exports", "scopeKind": "class"}, {"_type": "tag", "name": "registerUser", "path": "/home/kavia/workspace/code-generation/bookstore-browse-and-purchase-27252-27277/backend_api/src/services/auth.js", "pattern": "/^async function registerUser(email, password, name) {$/", "language": "JavaScript", "kind": "function", "signature": "(email, password, name)"}, {"_type": "tag", "name": "sub", "path": "/home/kavia/workspace/code-generation/bookstore-browse-and-purchase-27252-27277/backend_api/src/services/auth.js", "pattern": "/^  const payload = { sub: String(user.id), email: user.email, name: user.name };$/", "language": "JavaScript", "kind": "property", "scope": "issueJwt.payload", "scopeKind": "class"}, {"_type": "tag", "name": "verifyJwt", "path": "/home/kavia/workspace/code-generation/bookstore-browse-and-purchase-27252-27277/backend_api/src/services/auth.js", "pattern": "/^function verifyJwt(token) {$/", "language": "JavaScript", "kind": "function", "signature": "(token)"}], "hash": "0cd4fbad3b385ac3ff87d316b3b59c8d", "format-version": 4, "code-base-name": "backend_api", "filename": "backend_api/src/services/auth.js", "fields": [{"name": "const payload = { sub: String(user.id), email: user.email, name: user.name };", "scope": "issueJwt.payload", "scopeKind": "class", "description": "unavailable"}, {"name": "registerUser,", "scope": "module.exports", "scopeKind": "class", "description": "unavailable"}], "revision_history": [{"56": ""}]}